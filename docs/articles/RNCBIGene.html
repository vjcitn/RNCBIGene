<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>RNCBIGene: NCBI Gene annotation in parquet • RNCBIGene</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="RNCBIGene: NCBI Gene annotation in parquet">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">RNCBIGene</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/RNCBIGene.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="nav-link" href="https://github.com/vjcitn/RNCBIGene/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<link href="RNCBIGene_files/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="RNCBIGene_files/htmlwidgets-1.6.4/htmlwidgets.js"></script><link href="RNCBIGene_files/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="RNCBIGene_files/datatables-binding-0.33/datatables.js"></script><link href="RNCBIGene_files/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="RNCBIGene_files/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="RNCBIGene_files/dt-core-1.13.6/js/jquery.dataTables.min.js"></script><link href="RNCBIGene_files/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="RNCBIGene_files/crosstalk-1.2.1/js/crosstalk.min.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>RNCBIGene: NCBI Gene annotation in parquet</h1>
                        <h4 data-toc-skip class="author">Vincent J.
Carey, stvjc at channing.harvard.edu</h4>
            
            <h4 data-toc-skip class="date">May 18, 2025</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/vjcitn/RNCBIGene/blob/HEAD/vignettes/RNCBIGene.Rmd"><code>vignettes/RNCBIGene.Rmd</code></a></small>
      <div class="d-none name"><code>RNCBIGene.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Bioconductor’s annotation system has functioned for well over a
decade as a pivotal resource for analysis and tool development. See the
<a href="https://bioconductor.org/packages/AnnotationDbi" class="external-link">AnnotationDbi</a>
documentation for details. AnnotationDbi and packages based on it use
SQLite to manage organism-specific vocabularies and to resolve queries
about mappings between identifier sets. For example, learn the Gene
Ontology annotations for gene ORMDL3 in <em>Homo sapiens</em>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">org.Hs.eg.db</span><span class="op">)</span></span>
<span><span class="va">go_orm</span> <span class="op">=</span> <span class="fu">AnnotationDbi</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/AnnotationDbi/man/AnnotationDb-class.html" class="external-link">select</a></span><span class="op">(</span><span class="va">org.Hs.eg.db</span>, key<span class="op">=</span><span class="st">"ORMDL3"</span>, keytype<span class="op">=</span><span class="st">"SYMBOL"</span>,</span>
<span>    columns<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GO"</span>, <span class="st">"ENTREZID"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">go_orm</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   SYMBOL         GO EVIDENCE ONTOLOGY ENTREZID</span></span>
<span><span class="co">## 1 ORMDL3 GO:0002903      IMP       BP    94103</span></span>
<span><span class="co">## 2 ORMDL3 GO:0005515      IPI       MF    94103</span></span>
<span><span class="co">## 3 ORMDL3 GO:0005783      IDA       CC    94103</span></span>
<span><span class="co">## 4 ORMDL3 GO:0005789      IEA       CC    94103</span></span>
<span><span class="co">## 5 ORMDL3 GO:0005886      TAS       CC    94103</span></span>
<span><span class="co">## 6 ORMDL3 GO:0006672      IBA       BP    94103</span></span></code></pre>
<p>With RNCBIGene, all NCBI’s GO annotations for all organisms are in a
single resource. The <code>geneFromCache</code> package will retrieve
the Apache Parquet representation of the gene2go.gz text resource
distributed at NCBI’s FTP site. For this query, we use the knowledge the
ORMDL3 has Gene ID 94103.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/vjcitn/RNCBIGene">RNCBIGene</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="va">go_ds</span> <span class="op">=</span> <span class="fu">arrow</span><span class="fu">::</span><span class="fu"><a href="https://arrow.apache.org/docs/r/reference/open_dataset.html" class="external-link">open_dataset</a></span><span class="op">(</span><span class="fu"><a href="../reference/geneFromCache.html">geneFromCache</a></span><span class="op">(</span><span class="st">"gene2go.parquet"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">lkor</span> <span class="op">=</span> <span class="va">go_ds</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">`#tax_id`</span><span class="op">==</span><span class="fl">9606</span>, <span class="va">GeneID</span><span class="op">==</span><span class="fl">94103</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/compute.html" class="external-link">collect</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu">DT</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html" class="external-link">datatable</a></span><span class="op">(</span><span class="va">lkor</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-ac96cb3ee4656e2e9ec3" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-ac96cb3ee4656e2e9ec3">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21"],[9606,9606,9606,9606,9606,9606,9606,9606,9606,9606,9606,9606,9606,9606,9606,9606,9606,9606,9606,9606,9606],[94103,94103,94103,94103,94103,94103,94103,94103,94103,94103,94103,94103,94103,94103,94103,94103,94103,94103,94103,94103,94103],["GO:0002903","GO:0005515","GO:0005783","GO:0005789","GO:0005886","GO:0006672","GO:0006672","GO:0006686","GO:0006940","GO:0010508","GO:0010508","GO:0017059","GO:0017059","GO:0030148","GO:0030667","GO:0035579","GO:0042552","GO:0061744","GO:0090156","GO:1900060","GO:1900182"],["IMP","IPI","IDA","IEA","TAS","IBA","IMP","IEA","IEA","IDA","IMP","IBA","IDA","IBA","TAS","TAS","IEA","IEA","IBA","IMP","IDA"],["acts_upstream_of_or_within","enables","located_in","located_in","located_in","involved_in","involved_in","involved_in","involved_in","acts_upstream_of_or_within","acts_upstream_of_or_within","part_of","part_of","involved_in","located_in","located_in","involved_in","involved_in","involved_in","acts_upstream_of_or_within","acts_upstream_of_or_within"],["negative regulation of B cell apoptotic process","protein binding","endoplasmic reticulum","endoplasmic reticulum membrane","plasma membrane","ceramide metabolic process","ceramide metabolic process","sphingomyelin biosynthetic process","regulation of smooth muscle contraction","positive regulation of autophagy","positive regulation of autophagy","serine palmitoyltransferase complex","serine palmitoyltransferase complex","sphingolipid biosynthetic process","secretory granule membrane","specific granule membrane","myelination","motor behavior","intracellular sphingolipid homeostasis","negative regulation of ceramide biosynthetic process","positive regulation of protein localization to nucleus"],["28747345","20182505|32296183|33558761","12093374","-","-","-","20182505","-","-","28747345","28747345","-","20182505|25691431","-","-","-","-","-","-","25691431","28747345"],["Process","Function","Component","Component","Component","Process","Process","Process","Process","Process","Process","Component","Component","Process","Component","Component","Process","Process","Process","Process","Process"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>#tax_id<\/th>\n      <th>GeneID<\/th>\n      <th>GO_ID<\/th>\n      <th>Evidence<\/th>\n      <th>Qualifier<\/th>\n      <th>GO_term<\/th>\n      <th>PubMed<\/th>\n      <th>Category<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"#tax_id","targets":1},{"name":"GeneID","targets":2},{"name":"GO_ID","targets":3},{"name":"Evidence","targets":4},{"name":"Qualifier","targets":5},{"name":"GO_term","targets":6},{"name":"PubMed","targets":7},{"name":"Category","targets":8}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script><p>It is not the purpose of this package to provide pin-compatible
replacements for the AnnotationDbi packages. That would be a huge
effort, and material support for such an effort does not exist at this
time. This package is created to indicate the opportunities for
simplification and performance enhancement arising from the adoption of
Parquet and Arrow for annotation representation and interrogation.</p>
</div>
<div class="section level2">
<h2 id="scope">Scope<a class="anchor" aria-label="anchor" href="#scope"></a>
</h2>
<p>There are seven parquet files available through this package.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">RNCBIGene</span><span class="fu">:::</span><span class="va">available_gene_parquet</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "gene2go.parquet"                     </span></span>
<span><span class="co">## [2] "gene2pubmed.parquet"                 </span></span>
<span><span class="co">## [3] "gene_info.parquet"                   </span></span>
<span><span class="co">## [4] "gene2accession.parquet"              </span></span>
<span><span class="co">## [5] "gene2refseq.parquet"                 </span></span>
<span><span class="co">## [6] "gene_orthologs.parquet"              </span></span>
<span><span class="co">## [7] "gene_refseq_uniprotkb_collab.parquet"</span></span></code></pre>
<p>We can work with all of them “simultaneously”.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">paths</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu">RNCBIGene</span><span class="fu">:::</span><span class="va">available_gene_parquet</span>, <span class="va">geneFromCache</span><span class="op">)</span></span>
<span><span class="va">pop</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">paths</span>, <span class="fu">arrow</span><span class="fu">::</span><span class="va"><a href="https://arrow.apache.org/docs/r/reference/open_dataset.html" class="external-link">open_dataset</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">pop</span><span class="op">)</span> <span class="op">=</span> <span class="fu">RNCBIGene</span><span class="fu">:::</span><span class="va">available_gene_parquet</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">pop</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                      gene2go.parquet                  gene2pubmed.parquet </span></span>
<span><span class="co">##                            104591215                             63850913 </span></span>
<span><span class="co">##                    gene_info.parquet               gene2accession.parquet </span></span>
<span><span class="co">##                             58928318                            224922002 </span></span>
<span><span class="co">##                  gene2refseq.parquet               gene_orthologs.parquet </span></span>
<span><span class="co">##                             87197813                             13600744 </span></span>
<span><span class="co">## gene_refseq_uniprotkb_collab.parquet </span></span>
<span><span class="co">##                            175112694</span></span></code></pre>
<p>Illustration: find the UniProt identifiers associated with gene
ORMDL3 in humans.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pro</span> <span class="op">=</span> <span class="va">pop</span><span class="op">[[</span><span class="st">"gene2accession.parquet"</span><span class="op">]</span><span class="op">]</span> <span class="op">|&gt;</span> </span>
<span>   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">`#tax_id`</span> <span class="op">==</span> <span class="fl">9606</span>, <span class="va">Symbol</span> <span class="op">==</span> <span class="st">"ORMDL3"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">protein_accession.version</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/compute.html" class="external-link">collect</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">setdiff</a></span><span class="op">(</span><span class="st">"-"</span><span class="op">)</span></span>
<span><span class="va">pop</span><span class="op">[[</span><span class="st">"gene_refseq_uniprotkb_collab.parquet"</span><span class="op">]</span><span class="op">]</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">NCBI_tax_id</span> <span class="op">==</span> <span class="fl">9606</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">`#NCBI_protein_accession`</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">pro</span><span class="op">)</span>  <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/compute.html" class="external-link">collect</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 36 × 5</span></span></span>
<span><span class="co">##    `#NCBI_protein_accession` UniProtKB_protein_ac…¹ NCBI_tax_id UniProtKB_tax_id</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                        <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> NP_001307730.1            B3KS83                        <span style="text-decoration: underline;">9</span>606             <span style="text-decoration: underline;">9</span>606</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> NP_001307730.1            J3QRM9                        <span style="text-decoration: underline;">9</span>606             <span style="text-decoration: underline;">9</span>606</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> NP_001307730.1            Q6UY83                        <span style="text-decoration: underline;">9</span>606             <span style="text-decoration: underline;">9</span>606</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> NP_001307730.1            Q8N138                        <span style="text-decoration: underline;">9</span>606             <span style="text-decoration: underline;">9</span>606</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> NP_001307731.1            B3KS83                        <span style="text-decoration: underline;">9</span>606             <span style="text-decoration: underline;">9</span>606</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> NP_001307731.1            J3QRM9                        <span style="text-decoration: underline;">9</span>606             <span style="text-decoration: underline;">9</span>606</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> NP_001307731.1            Q6UY83                        <span style="text-decoration: underline;">9</span>606             <span style="text-decoration: underline;">9</span>606</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> NP_001307731.1            Q8N138                        <span style="text-decoration: underline;">9</span>606             <span style="text-decoration: underline;">9</span>606</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> NP_001307732.1            B3KS83                        <span style="text-decoration: underline;">9</span>606             <span style="text-decoration: underline;">9</span>606</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> NP_001307732.1            J3QRM9                        <span style="text-decoration: underline;">9</span>606             <span style="text-decoration: underline;">9</span>606</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 26 more rows</span></span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ abbreviated name: ¹​UniProtKB_protein_accession</span></span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 1 more variable: method &lt;chr&gt;</span></span></span></code></pre>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Vince Carey.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
